{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "access_key_id": {
      "type": "string",
      "default": null
    },
    "api_timeout": {
      "type": "string",
      "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
      "default": null
    },
    "cloudtrail_digest_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail Digest S3 Objects.  If\nblank CloudTrail Digest logs will be skipped.\n",
      "default": "/CloudTrail-Digest/"
    },
    "cloudtrail_insight_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail Insight S3 Objects.  If\nblank CloudTrail Insight logs will be skipped.\n",
      "default": "/CloudTrail-Insight/"
    },
    "cloudtrail_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail S3 Objects.  If blank\nCloudTrail logs will be skipped.\n",
      "default": "/CloudTrail/"
    },
    "credential_profile_name": {
      "type": "string",
      "default": null
    },
    "default_region": {
      "type": "string",
      "description": "Default region to use prior to connecting to region specific services/endpoints if no AWS region is set from environment variable, credentials or instance profile. If none of the above are set and no default region is set as well, `us-east-1` is used. A region, either from environment variable, credentials or instance profile or from this default region setting, needs to be set when using regions in non-regular AWS environments such as AWS China or US Government Isolated.",
      "default": ""
    },
    "fips_enabled": {
      "type": "bool",
      "description": "Enabling this option changes the service name from `s3` to `s3-fips` for connecting to the correct service endpoint.",
      "default": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the aws package to use.",
      "default": "1.33.3"
    },
    "max_number_of_messages": {
      "type": "number",
      "description": "The maximum number of SQS messages that can be inflight at any time.",
      "default": 5
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
      "default": null
    },
    "proxy_url": {
      "type": "string",
      "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
      "default": null
    },
    "queue_url": {
      "type": "string",
      "description": "URL of the AWS SQS queue that messages will be received from.",
      "nullable": false
    },
    "role_arn": {
      "type": "string",
      "default": null
    },
    "secret_access_key": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "session_token": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "shared_credential_file": {
      "type": "string",
      "description": "Directory of the shared credentials file",
      "default": null
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "aws-cloudtrail"
      ]
    },
    "visibility_timeout": {
      "type": "string",
      "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
      "default": null
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "cloudtrail"
      ],
      "data_stream": "cloudtrail",
      "data_stream_variables_json": "${jsonencode({\n  api_timeout = var.api_timeout\n  cloudtrail_digest_regex = var.cloudtrail_digest_regex\n  cloudtrail_insight_regex = var.cloudtrail_insight_regex\n  cloudtrail_regex = var.cloudtrail_regex\n  fips_enabled = var.fips_enabled\n  max_number_of_messages = var.max_number_of_messages\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  queue_url = var.queue_url\n  tags = var.tags\n  visibility_timeout = var.visibility_timeout\n})}",
      "input_type": "aws-s3",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "aws",
      "package_policy_name": "aws-cloudtrail-${var.fleet_data_stream_namespace}",
      "package_variables_json": "${jsonencode({\n  access_key_id = var.access_key_id\n  credential_profile_name = var.credential_profile_name\n  default_region = var.default_region\n  proxy_url = var.proxy_url\n  role_arn = var.role_arn\n  secret_access_key = var.secret_access_key\n  session_token = var.session_token\n  shared_credential_file = var.shared_credential_file\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "cloudtrail",
      "source": "../../fleet_package_policy"
    }
  }
}
