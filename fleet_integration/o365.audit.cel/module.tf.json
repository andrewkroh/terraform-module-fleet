{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "azure_tenant_id": {
      "type": "string",
      "description": "Directory (tenant) ID",
      "nullable": false
    },
    "batch_interval": {
      "type": "string",
      "description": "Interval for each API request. The default fetches a single hour of events for each request. This value may not be more than 24h. Supports following suffixes - \"h\" (hour), \"m\" (minute), \"s\" (second), \"ms\" (millisecond), \"us\" (microsecond), and \"ns\" (nanosecond)",
      "default": "1h",
      "nullable": false
    },
    "client_id": {
      "type": "string",
      "description": "Client ID used for OAuth 2.0 authentication",
      "nullable": false
    },
    "client_secret": {
      "type": "string",
      "description": "Client secret used for OAuth 2.0 authentication",
      "sensitive": true,
      "nullable": false
    },
    "content_types": {
      "type": "string",
      "description": "Comma separated list of content types to fetch from Management API.\nSupported content types are - `Audit.AzureActiveDirectory, Audit.Exchange, Audit.SharePoint, Audit.General, DLP.All`.\n\nMore information can be found in the [documentation](https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-reference#working-with-the-office-365-management-activity-api).",
      "default": "Audit.AzureActiveDirectory, Audit.Exchange, Audit.SharePoint, Audit.General, DLP.All",
      "nullable": false
    },
    "enable_request_tracer": {
      "type": "bool",
      "description": "The request tracer logs requests and responses to the agent's local file-system for debugging configurations. Enabling this request tracing compromises security and should only be used for debugging. Disabling the request tracer will delete any stored traces. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-cel.html#_resource_tracer_enable) for details.",
      "default": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the o365 package to use.",
      "default": "3.3.0"
    },
    "initial_interval": {
      "type": "string",
      "description": "Initial interval for the first API call. Default starts fetching events from 167h55m, i.e., 7 days ago, and must not go further back than that. Supports following suffixes - \"h\" (hour), \"m\" (minute), \"s\" (second), \"ms\" (millisecond), \"us\" (microsecond), and \"ns\" (nanosecond)",
      "default": "167h55m",
      "nullable": false
    },
    "interval": {
      "type": "string",
      "description": "How often the API is polled, supports seconds, minutes and hours.",
      "default": "3m",
      "nullable": false
    },
    "max_executions": {
      "type": "number",
      "description": "Maximum Executions Per Interval is the maximum number of executions that can be performed without waiting for the interval time.",
      "default": 10000
    },
    "maximum_age": {
      "type": "string",
      "description": "A hard maximum age limit for data that can be requested. It defaults to 5 mins less than the API's documented limit but may be shortened as a workaround for errors related to expired data. Supports following suffixes - \"h\" (hour), \"m\" (minute), \"s\" (second), \"ms\" (millisecond), \"us\" (microsecond), and \"ns\" (nanosecond)",
      "default": "167h55m",
      "nullable": false
    },
    "oauth_endpoint_params_yaml": {
      "type": "string",
      "description": "Endpoint Params used for OAuth2 authentication as YAML. See [documentation](https://www.elastic.co/docs/reference/beats/filebeat/filebeat-input-cel#_auth_oauth2_endpoint_params) for details.",
      "default": "grant_type: client_credentials\n",
      "nullable": false
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
      "default": null
    },
    "resource_proxy_url": {
      "type": "string",
      "description": "This specifies proxy configuration in the form of `http[s]://<user>:<password>@<server name/ip>:<port>`.",
      "default": null
    },
    "resource_rate_limit_burst": {
      "type": "string",
      "description": "The maximum burst size. Burst is the maximum number of resource requests that can be made above the overall rate limit.",
      "default": null
    },
    "resource_rate_limit_limit": {
      "type": "string",
      "description": "Value of the response that specifies the total limit.",
      "default": null
    },
    "resource_redirect_forward_headers": {
      "type": "bool",
      "description": "If set to true resource headers are forwarded in case of a redirect. Default is \"false\".",
      "default": null
    },
    "resource_redirect_headers_ban_list": {
      "type": "list(string)",
      "description": "If \"Redirect Forward Headers\" is set to true, all headers except the ones defined in this list will be forwarded. All headers are forwarded by default.",
      "default": null
    },
    "resource_redirect_max_redirects": {
      "type": "string",
      "description": "Maximum number of redirects to follow for a resource. Default is \"10\".",
      "default": null
    },
    "resource_retry_max_attempts": {
      "type": "string",
      "description": "Maximum number of retries for the HTTP client. Default is \"5\".",
      "default": null
    },
    "resource_retry_wait_max": {
      "type": "string",
      "description": "Maximum time to wait before a retry is attempted. Default is \"60s\".",
      "default": null
    },
    "resource_retry_wait_min": {
      "type": "string",
      "description": "Minimum time to wait before a retry is attempted. Default is \"1s\".",
      "default": null
    },
    "resource_ssl_yaml": {
      "type": "string",
      "description": "i.e. certificate_authorities, supported_protocols, verification_mode etc, more examples found in the [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config)",
      "default": null
    },
    "resource_timeout": {
      "type": "string",
      "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h. Default is \"30\"s.",
      "default": "60s"
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "o365-cel"
      ]
    },
    "token_scopes": {
      "type": "list(string)",
      "description": "Scopes for OAuth 2.0 token.",
      "default": [
        "https://manage.office.com/.default"
      ],
      "nullable": false
    },
    "token_url": {
      "type": "string",
      "description": "Base URL endpoint that will be used to generate the tokens during the OAuth 2.0 flow. If not provided, above `Azure Tenant ID` will be used for OAuth 2.0 token generation. Default value - `https://login.microsoftonline.com`",
      "default": "https://login.microsoftonline.com",
      "sensitive": true
    },
    "url": {
      "type": "string",
      "default": "https://manage.office.com"
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "audit"
      ],
      "all_policy_template_inputs": [
        "o365-cel",
        "o365-o365audit"
      ],
      "data_stream": "audit",
      "data_stream_variables_json": "${jsonencode({\n  azure_tenant_id = var.azure_tenant_id\n  batch_interval = var.batch_interval\n  client_id = var.client_id\n  client_secret = var.client_secret\n  content_types = var.content_types\n  enable_request_tracer = var.enable_request_tracer\n  initial_interval = var.initial_interval\n  interval = var.interval\n  max_executions = var.max_executions\n  maximum_age = var.maximum_age\n  oauth_endpoint_params = var.oauth_endpoint_params_yaml\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  resource_proxy_url = var.resource_proxy_url\n  resource_rate_limit_burst = var.resource_rate_limit_burst\n  resource_rate_limit_limit = var.resource_rate_limit_limit\n  resource_redirect_forward_headers = var.resource_redirect_forward_headers\n  resource_redirect_headers_ban_list = var.resource_redirect_headers_ban_list\n  resource_redirect_max_redirects = var.resource_redirect_max_redirects\n  resource_retry_max_attempts = var.resource_retry_max_attempts\n  resource_retry_wait_max = var.resource_retry_wait_max\n  resource_retry_wait_min = var.resource_retry_wait_min\n  resource_ssl = var.resource_ssl_yaml\n  resource_timeout = var.resource_timeout\n  tags = var.tags\n  token_scopes = var.token_scopes\n  token_url = var.token_url\n  url = var.url\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "cel",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "o365",
      "package_policy_name": "o365-audit-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "o365",
      "source": "../../fleet_package_policy"
    }
  }
}
