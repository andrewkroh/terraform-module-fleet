{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "arm_template_url": {
      "type": "string",
      "description": "A URL to the ARM Template for creating a new deployment",
      "default": "https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Felastic%2Fcloudbeat%2F8.17%2Fdeploy%2Fazure%2FARM-for-ACCOUNT_TYPE.json",
      "nullable": false
    },
    "azure_account_type": {
      "type": "string",
      "default": null
    },
    "azure_credentials_client_certificate_password": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "azure_credentials_client_certificate_path": {
      "type": "string",
      "default": null
    },
    "azure_credentials_client_id": {
      "type": "string",
      "default": null
    },
    "azure_credentials_client_password": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "azure_credentials_client_secret": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "azure_credentials_client_username": {
      "type": "string",
      "default": null
    },
    "azure_credentials_tenant_id": {
      "type": "string",
      "default": null
    },
    "azure_credentials_type": {
      "type": "string",
      "default": null
    },
    "condition": {
      "type": "string",
      "description": "Condition to filter when to collect this input. See [Dynamic Input Configuration](https://www.elastic.co/guide/en/fleet/current/dynamic-input-configuration.html) for details.\n",
      "default": null
    },
    "deployment": {
      "type": "string",
      "description": "Chosen deployment type (aws/gcp/azure/eks/k8s)",
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the cloud_security_posture package to use.",
      "default": "1.12.0"
    },
    "posture": {
      "type": "string",
      "description": "Chosen posture type (cspm/kspm)",
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "findings"
      ],
      "all_policy_template_inputs": [
        "kspm-cloudbeat/cis_k8s",
        "kspm-cloudbeat/cis_eks",
        "cspm-cloudbeat/cis_aws",
        "cspm-cloudbeat/cis_gcp",
        "cspm-cloudbeat/cis_azure",
        "vuln_mgmt-cloudbeat/vuln_mgmt_aws"
      ],
      "data_stream": "findings",
      "data_stream_variables_json": "${jsonencode({\n  \"azure.account_type\" = var.azure_account_type\n  \"azure.credentials.client_certificate_password\" = var.azure_credentials_client_certificate_password\n  \"azure.credentials.client_certificate_path\" = var.azure_credentials_client_certificate_path\n  \"azure.credentials.client_id\" = var.azure_credentials_client_id\n  \"azure.credentials.client_password\" = var.azure_credentials_client_password\n  \"azure.credentials.client_secret\" = var.azure_credentials_client_secret\n  \"azure.credentials.client_username\" = var.azure_credentials_client_username\n  \"azure.credentials.tenant_id\" = var.azure_credentials_tenant_id\n  \"azure.credentials.type\" = var.azure_credentials_type\n  condition = var.condition\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "cloudbeat/cis_azure",
      "input_variables_json": "${jsonencode({\n  arm_template_url = var.arm_template_url\n})}",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "cloud_security_posture",
      "package_policy_name": "cloud_security_posture-findings-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  deployment = var.deployment\n  posture = var.posture\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "cspm",
      "source": "../../fleet_package_policy"
    }
  }
}
