{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "access_key_id": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "access_point_arn": {
      "type": "string",
      "description": "Mandatory if the \"Collect logs via S3 Bucket\" switch is on. It is a required parameter for collecting logs via the AWS S3 Bucket unless you set a Bucket ARN.",
      "default": null
    },
    "actor_target_mapping": {
      "type": "bool",
      "description": "Maps and classifies actor and target entity identifiers by type. Actor entities populate `actor.entity.id` and type-specific fields (`user.entity.id`, `service.entity.id`, `host.entity.id`, `entity.id`). Target entities populate `target.entity.id` and corresponding type-specific fields (`user.target.entity.id`, `service.target.entity.id`, `host.target.entity.id`, `entity.target.id`). All identifiers are captured in the `related.entity` field. This Enables enhanced entity visualization in Security Solution. Additional ingest pipeline processors may introduce performance overhead.\n",
      "default": true,
      "nullable": false
    },
    "api_timeout": {
      "type": "string",
      "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
      "default": null
    },
    "bucket_arn": {
      "type": "string",
      "description": "Mandatory if the \"Collect logs via S3 Bucket\" switch is on. It is a required parameter for collecting logs via the AWS S3 Bucket unless you set an Access Point ARN. In case both configurations are added, this one takes precedence.",
      "default": null
    },
    "bucket_list_prefix": {
      "type": "string",
      "description": "Prefix to apply for the list request to the S3 bucket.",
      "default": null
    },
    "cloudtrail_digest_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail Digest S3 Objects.  If\nblank CloudTrail Digest logs will be skipped.\n",
      "default": "/CloudTrail-Digest/"
    },
    "cloudtrail_insight_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail Insight S3 Objects.  If\nblank CloudTrail Insight logs will be skipped.\n",
      "default": "/CloudTrail-Insight/"
    },
    "cloudtrail_regex": {
      "type": "string",
      "description": "Regex to match path of CloudTrail S3 Objects.  If blank\nCloudTrail logs will be skipped.\n",
      "default": "/CloudTrail/"
    },
    "collect_s3_logs": {
      "type": "bool",
      "description": "To Collect logs via S3 bucket enable the toggle switch. By default, it will collect logs via SQS Queue.",
      "default": false,
      "nullable": false
    },
    "credential_profile_name": {
      "type": "string",
      "default": null
    },
    "custom_yaml": {
      "type": "string",
      "description": "Additional settings to be added to the configuration. Be careful using this as it might break the input as those settings are not validated and can override the settings specified above. See [`aws-s3` input settings docs](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-aws-s3.html) for details.\n",
      "default": null
    },
    "default_region": {
      "type": "string",
      "description": "Default region to use prior to connecting to region specific services/endpoints if no AWS region is set from environment variable, credentials or instance profile. If none of the above are set and no default region is set as well, `us-east-1` is used. A region, either from environment variable, credentials or instance profile or from this default region setting, needs to be set when using regions in non-regular AWS environments such as AWS China or US Government Isolated.",
      "default": ""
    },
    "endpoint": {
      "type": "string",
      "description": "URL of the entry point for an AWS web service",
      "default": ""
    },
    "external_id": {
      "type": "string",
      "description": "External ID to use when assuming a role in another account, see [the AWS documentation for use of external IDs](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html)",
      "default": null
    },
    "fips_enabled": {
      "type": "bool",
      "description": "Enabling this option changes the service name from `s3` to `s3-fips` for connecting to the correct service endpoint.",
      "default": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_force": {
      "type": "bool",
      "description": "Force reinstallation of the package even if already installed. When true, bypasses \"already installed\" checks and triggers complete re-installation. This deletes and recreates Kibana assets (dashboards, visualizations), removes transforms and their destination indices, and overwrites ingest pipelines and templates.",
      "default": true
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the aws package to use.",
      "default": "5.6.1"
    },
    "ignore_older": {
      "type": "string",
      "description": "If set, ignore S3 objects whose Last-Modified time is before the ignore older timespan. Timespan is checked from the current time to S3 object's Last-Modified time. Accepts a duration like `48h`, `2h30m`.",
      "default": null
    },
    "interval": {
      "type": "string",
      "description": "Time interval for polling listing of the S3 bucket. NOTE: Supported units for this parameter are h/m/s.",
      "default": "1m"
    },
    "max_number_of_messages": {
      "type": "number",
      "description": "The maximum number of SQS messages that can be inflight at any time. Defaults to 5. When processing large amount of large size S3 objects and each object has large amount of events, if this parameter sets too high, it can cause the input to process too many messages concurrently, overload the agent and cause ingest failure. We recommend to keep the default value 5 and use the [preset](https://www.elastic.co/guide/en/fleet/current/es-output-settings.html#es-output-settings-performance-tuning-settings) option to tune your Elastic Agent performance. You can optimize for throughput, scale, latency, or you can choose a balanced (the default) set of performance specifications.\n",
      "default": 5
    },
    "number_of_workers": {
      "type": "number",
      "description": "Number of workers that will process the S3 objects listed.",
      "default": 5
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
      "default": null
    },
    "proxy_url": {
      "type": "string",
      "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
      "default": null
    },
    "queue_url": {
      "type": "string",
      "description": "Mandatory if the \"Collect logs via S3 Bucket\" switch is off. URL of the AWS SQS queue that messages will be received from.",
      "default": null
    },
    "region": {
      "type": "string",
      "description": "The name of the AWS region of the endpoint",
      "default": ""
    },
    "retain": {
      "type": "string",
      "description": "Cloudtrail `response_elements`, `request_parameters` and `additional_eventdata` data can be placed in keyword and text fields as JSON, and in flattened fields. Depending on requirements this configuration determines which fields will be retained in the final document. The Minimal option retains the minimal set of fields required for the Security Detection Engine rules.",
      "default": "all"
    },
    "role_arn": {
      "type": "string",
      "default": null
    },
    "secret_access_key": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "session_token": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "shared_credential_file": {
      "type": "string",
      "description": "Directory of the shared credentials file",
      "default": null
    },
    "start_timestamp": {
      "type": "string",
      "description": "If set, only read S3 objects with last modified timestamp newer than the given timestamp. Accepts a timestamp in `YYYY-MM-DDTHH:MM:SSZ` format. For example, \"2020-10-10T10:30:00Z\" (UTC) or \"2020-10-10T10:30:00Z+02:30\" (with zone offset).",
      "default": null
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "aws-cloudtrail"
      ]
    },
    "visibility_timeout": {
      "type": "string",
      "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
      "default": null
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "cloudtrail"
      ],
      "all_policy_template_inputs": [
        "awshealth-aws/metrics",
        "billing-aws/metrics",
        "cloudtrail-aws-s3",
        "cloudtrail-aws-cloudwatch",
        "cloudwatch-aws-cloudwatch",
        "cloudwatch-aws/metrics",
        "config-cel",
        "dynamodb-aws/metrics",
        "ebs-aws/metrics",
        "ec2-aws-s3",
        "ec2-aws-cloudwatch",
        "ec2-aws/metrics",
        "ecs-aws/metrics",
        "elb-aws-s3",
        "elb-aws-cloudwatch",
        "elb-aws/metrics",
        "lambda-aws/metrics",
        "lambda-aws-cloudwatch",
        "natgateway-aws/metrics",
        "firewall-aws-s3",
        "firewall-aws-cloudwatch",
        "firewall-aws/metrics",
        "rds-aws/metrics",
        "s3-aws-s3",
        "s3-aws/metrics",
        "s3_storage_lens-aws/metrics",
        "sns-aws/metrics",
        "sqs-aws/metrics",
        "transitgateway-aws/metrics",
        "usage-aws/metrics",
        "vpcflow-aws-s3",
        "vpcflow-aws-cloudwatch",
        "vpn-aws/metrics",
        "waf-aws-s3",
        "waf-aws-cloudwatch",
        "route53-aws-cloudwatch",
        "route53-aws-s3",
        "cloudfront-aws-s3",
        "redshift-aws/metrics",
        "kinesis-aws/metrics",
        "securityhub-httpjson",
        "inspector-httpjson",
        "guardduty-httpjson",
        "guardduty-aws-s3",
        "apigateway-aws/metrics",
        "apigateway-aws-s3",
        "apigateway-aws-cloudwatch",
        "emr-aws/metrics",
        "emr-aws-s3",
        "emr-aws-cloudwatch",
        "kafka-aws/metrics"
      ],
      "data_stream": "cloudtrail",
      "data_stream_variables_json": "${jsonencode({\n  access_point_arn = var.access_point_arn\n  actor_target_mapping = var.actor_target_mapping\n  api_timeout = var.api_timeout\n  bucket_arn = var.bucket_arn\n  bucket_list_prefix = var.bucket_list_prefix\n  cloudtrail_digest_regex = var.cloudtrail_digest_regex\n  cloudtrail_insight_regex = var.cloudtrail_insight_regex\n  cloudtrail_regex = var.cloudtrail_regex\n  collect_s3_logs = var.collect_s3_logs\n  custom = var.custom_yaml\n  endpoint = var.endpoint\n  fips_enabled = var.fips_enabled\n  ignore_older = var.ignore_older\n  interval = var.interval\n  max_number_of_messages = var.max_number_of_messages\n  number_of_workers = var.number_of_workers\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  queue_url = var.queue_url\n  region = var.region\n  retain = var.retain\n  start_timestamp = var.start_timestamp\n  tags = var.tags\n  visibility_timeout = var.visibility_timeout\n})}",
      "description": "${var.fleet_package_policy_description}",
      "force": "${var.fleet_package_policy_force}",
      "input_type": "aws-s3",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "aws",
      "package_policy_name": "aws-cloudtrail-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  access_key_id = var.access_key_id\n  credential_profile_name = var.credential_profile_name\n  default_region = var.default_region\n  external_id = var.external_id\n  proxy_url = var.proxy_url\n  role_arn = var.role_arn\n  secret_access_key = var.secret_access_key\n  session_token = var.session_token\n  shared_credential_file = var.shared_credential_file\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "cloudtrail",
      "source": "../../fleet_package_policy"
    }
  }
}
