{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "access_id": {
      "type": "string",
      "description": "Access ID of a ThreatConnect API User.",
      "nullable": false
    },
    "batch_size": {
      "type": "number",
      "description": "Batch size for the response of the ThreatConnect API. The maximum supported batch size value is 10000.",
      "default": 2000,
      "nullable": false
    },
    "enable_request_tracer": {
      "type": "bool",
      "description": "The request tracer logs requests and responses to the agent's local file-system for debugging configurations. Enabling this request tracing compromises security and should only be used for debugging. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-httpjson.html#_request_tracer_filename) for details.",
      "default": null
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the ti_threatconnect package to use.",
      "default": "1.10.0"
    },
    "http_client_timeout": {
      "type": "string",
      "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.",
      "default": "2m",
      "nullable": false
    },
    "include_attributes": {
      "type": "bool",
      "description": "Elastic has a default async search response size of 10MB. Enabling this option may result in larger response size, which may cause problems when using the Kibana discover view.",
      "default": false
    },
    "include_group_assoc": {
      "type": "bool",
      "description": "Elastic has a default async search response size of 10MB. Enabling this option may result in larger response size, which may cause problems when using the Kibana discover view.",
      "default": false
    },
    "include_group_assoc_attribs": {
      "type": "bool",
      "description": "This requires the API user account to have the option \"Allow User to Exceed API Link Limit\" enabled. Elastic has a default async search response size of 10MB. Enabling this option may result in larger response size, which may cause problems when using the Kibana discover view.",
      "default": false
    },
    "include_indicator_assoc": {
      "type": "bool",
      "description": "Elastic has a default async search response size of 10MB. Enabling this option may result in larger response size, which may cause problems when using the Kibana discover view.",
      "default": false
    },
    "initial_interval": {
      "type": "string",
      "description": "How far back to pull Indicators and the groups associated with those indicators from ThreatConnect. Supported units for this parameter are h/m/s.",
      "default": "168h",
      "nullable": false
    },
    "interval": {
      "type": "string",
      "description": "Duration between requests to the ThreatConnect API. Supported units for this parameter are h/m/s.",
      "default": "24h",
      "nullable": false
    },
    "ioc_expiration_duration": {
      "type": "string",
      "description": "Enforces all IOCs to expire after this duration. This setting is required to avoid \"orphaned\" IOCs that never expire. Specify [Elasticsearch time units](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units) using only days, hours, or minutes (e.g., 10d), avoiding mixed time units.",
      "default": "90d",
      "nullable": false
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`.",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.",
      "default": null
    },
    "proxy_url": {
      "type": "string",
      "description": "URL to proxy connections in the form of http[s]://<user>:<password>@<server name/ip>:<port>. Please ensure your username and password are in URL encoded format.",
      "default": null
    },
    "secret_key": {
      "type": "string",
      "description": "Secret Key of a ThreatConnect API User.",
      "sensitive": true,
      "nullable": false
    },
    "ssl_yaml": {
      "type": "string",
      "description": "SSL configuration options. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config) for details.",
      "default": null
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "threatconnect-indicator"
      ],
      "nullable": false
    },
    "tql": {
      "type": "string",
      "description": "Filter results based on query written in [TQL](https://knowledge.threatconnect.com/docs/constructing-query-expressions).",
      "default": null
    },
    "url": {
      "type": "string",
      "description": "Base URL of the ThreatConnect API. Default URL given is for ThreatConnect's Public Cloud instance. Note: Do not include trailing slash “/” character.",
      "default": "https://app.threatconnect.com",
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "indicator"
      ],
      "all_policy_template_inputs": [
        "threatconnect-cel"
      ],
      "data_stream": "indicator",
      "data_stream_variables_json": "${jsonencode({\n  batch_size = var.batch_size\n  enable_request_tracer = var.enable_request_tracer\n  http_client_timeout = var.http_client_timeout\n  include_attributes = var.include_attributes\n  include_group_assoc = var.include_group_assoc\n  include_group_assoc_attribs = var.include_group_assoc_attribs\n  include_indicator_assoc = var.include_indicator_assoc\n  initial_interval = var.initial_interval\n  interval = var.interval\n  ioc_expiration_duration = var.ioc_expiration_duration\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  tags = var.tags\n  tql = var.tql\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "cel",
      "input_variables_json": "${jsonencode({\n  access_id = var.access_id\n  proxy_url = var.proxy_url\n  secret_key = var.secret_key\n  ssl = var.ssl_yaml\n  url = var.url\n})}",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "ti_threatconnect",
      "package_policy_name": "ti_threatconnect-indicator-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "threatconnect",
      "source": "../../fleet_package_policy"
    }
  }
}
