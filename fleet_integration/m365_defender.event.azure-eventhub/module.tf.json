{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "connection_string": {
      "type": "string",
      "description": "The connection string required to communicate with Event Hubs. See [Get an Event Hubs connection string](https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string) to learn more.",
      "sensitive": true,
      "nullable": false
    },
    "consumer_group": {
      "type": "string",
      "description": "We recommend using a dedicated consumer group for the azure input. Reusing consumer groups among non-related consumers can cause unexpected behavior and possibly lost events.",
      "default": "$Default",
      "nullable": false
    },
    "eventhub": {
      "type": "string",
      "description": "Elastic recommends using one event hub for each integration. Visit [Create an event hub](https://docs.elastic.co/integrations/azure#create-an-event-hub) to learn more. Use event hub names up to 30 characters long to avoid compatibility issues.",
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the m365_defender package to use.",
      "default": "3.5.0"
    },
    "preserve_duplicate_custom_fields": {
      "type": "bool",
      "description": "Preserve m365_defender.event fields that were copied to Elastic Common Schema (ECS) fields.",
      "default": false,
      "nullable": false
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`.",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.",
      "default": null
    },
    "resource_manager_endpoint": {
      "type": "string",
      "description": "By default we are using the azure public environment, to override, users can provide a specific resource manager endpoint in order to use a different azure environment.",
      "default": null
    },
    "storage_account": {
      "type": "string",
      "description": "The name of the storage account where the consumer group's state/offsets will be stored and updated.",
      "nullable": false
    },
    "storage_account_container": {
      "type": "string",
      "description": "The storage account container where the integration stores the checkpoint data for the consumer group. It is an advanced option to use with extreme care. You MUST use a dedicated storage account container for each Azure log type. DO NOT REUSE the same container name for more than one Azure log type. See [Container Names](https://docs.microsoft.com/en-us/rest/api/storageservices/naming-and-referencing-containers--blobs--and-metadata#container-names) for details on naming rules from Microsoft. The integration generates a default container name if not specified.",
      "default": null
    },
    "storage_account_key": {
      "type": "string",
      "description": "The storage account key, this key will be used to authorize access to data in your storage account.",
      "sensitive": true,
      "nullable": false
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "m365_defender-event"
      ],
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "event"
      ],
      "all_policy_template_inputs": [
        "m365_defender-httpjson",
        "m365_defender-azure-eventhub"
      ],
      "data_stream": "event",
      "data_stream_variables_json": "${jsonencode({\n  connection_string = var.connection_string\n  consumer_group = var.consumer_group\n  eventhub = var.eventhub\n  preserve_duplicate_custom_fields = var.preserve_duplicate_custom_fields\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  resource_manager_endpoint = var.resource_manager_endpoint\n  storage_account = var.storage_account\n  storage_account_container = var.storage_account_container\n  storage_account_key = var.storage_account_key\n  tags = var.tags\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "azure-eventhub",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "m365_defender",
      "package_policy_name": "m365_defender-event-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "m365_defender",
      "source": "../../fleet_package_policy"
    }
  }
}
