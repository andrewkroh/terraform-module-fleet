{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "app_id": {
      "type": "string",
      "description": "App ID for the CrowdStrike.",
      "nullable": false
    },
    "client_id": {
      "type": "string",
      "description": "Client ID for the CrowdStrike.",
      "nullable": false
    },
    "client_secret": {
      "type": "string",
      "description": "Client Secret for the CrowdStrike.",
      "sensitive": true,
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the crowdstrike package to use.",
      "default": "2.7.0"
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`.",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
      "default": null
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "crowdstrike-falcon"
      ],
      "nullable": false
    },
    "token_url": {
      "type": "string",
      "description": "Token URL of CrowdStrike.",
      "default": "https://api.crowdstrike.com/oauth2/token",
      "sensitive": true,
      "nullable": false
    },
    "url": {
      "type": "string",
      "description": "Base URL of the CrowdStrike API. Defaults to https://api.crowdstrike.com.",
      "default": "https://api.crowdstrike.com",
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "falcon"
      ],
      "all_policy_template_inputs": [
        "crowdstrike-logfile",
        "crowdstrike-aws-s3",
        "crowdstrike-streaming",
        "crowdstrike-cel"
      ],
      "data_stream": "falcon",
      "data_stream_variables_json": "${jsonencode({\n  app_id = var.app_id\n  client_id = var.client_id\n  client_secret = var.client_secret\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  tags = var.tags\n  token_url = var.token_url\n  url = var.url\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "streaming",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "crowdstrike",
      "package_policy_name": "crowdstrike-falcon-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "crowdstrike",
      "source": "../../fleet_package_policy"
    }
  }
}
