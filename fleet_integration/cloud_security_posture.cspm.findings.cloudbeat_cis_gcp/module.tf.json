{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "cloud_shell_url": {
      "type": "string",
      "description": "A URL to CloudShell for creating a new deployment",
      "default": "https://shell.cloud.google.com/cloudshell/?ephemeral=true\u0026cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Felastic%2Fcloudbeat\u0026cloudshell_git_branch=main\u0026cloudshell_workspace=deploy%2Finfrastructure-manager%2Fgcp-elastic-agent\u0026show=terminal",
      "nullable": false
    },
    "cloud_shell_url_cloud_connectors": {
      "type": "string",
      "description": "A URL to CloudShell for creating a Cloud Connectors Service Account",
      "default": "https://shell.cloud.google.com/cloudshell/?ephemeral=true\u0026cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Felastic%2Fcloudbeat\u0026cloudshell_git_branch=main\u0026cloudshell_workspace=deploy%2Finfrastructure-manager%2Fgcp-cloud-connectors\u0026show=terminal",
      "nullable": false
    },
    "condition": {
      "type": "string",
      "description": "Condition to filter when to collect this input. See [Dynamic Input Configuration](https://www.elastic.co/guide/en/fleet/current/dynamic-input-configuration.html) for details.\n",
      "default": null
    },
    "deployment": {
      "type": "string",
      "description": "Chosen deployment type (aws/gcp/azure/eks/k8s)",
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_force": {
      "type": "bool",
      "description": "Force reinstallation of the package even if already installed. When true, bypasses \"already installed\" checks and triggers complete re-installation. This deletes and recreates Kibana assets (dashboards, visualizations), removes transforms and their destination indices, and overwrites ingest pipelines and templates.",
      "default": true
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the cloud_security_posture package to use.",
      "default": "3.3.0-preview05"
    },
    "gcp_account_type": {
      "type": "string",
      "default": null
    },
    "gcp_credentials_audience": {
      "type": "string",
      "default": null
    },
    "gcp_credentials_cloud_connector_id": {
      "type": "string",
      "description": "Required when using Cloud Connectors Managed Identity",
      "default": null
    },
    "gcp_credentials_file": {
      "type": "string",
      "default": null
    },
    "gcp_credentials_json": {
      "type": "string",
      "default": null
    },
    "gcp_credentials_service_account_email": {
      "type": "string",
      "default": null
    },
    "gcp_credentials_type": {
      "type": "string",
      "default": null
    },
    "gcp_organization_id": {
      "type": "string",
      "default": null
    },
    "gcp_project_id": {
      "type": "string",
      "default": null
    },
    "gcp_supports_cloud_connectors": {
      "type": "bool",
      "default": null
    },
    "posture": {
      "type": "string",
      "description": "Chosen posture type (cspm/kspm)",
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "findings"
      ],
      "all_policy_template_inputs": [
        "kspm-cloudbeat/cis_k8s",
        "kspm-cloudbeat/cis_eks",
        "cspm-cloudbeat/cis_aws",
        "cspm-cloudbeat/cis_gcp",
        "cspm-cloudbeat/cis_azure",
        "vuln_mgmt-cloudbeat/vuln_mgmt_aws"
      ],
      "data_stream": "findings",
      "data_stream_variables_json": "${jsonencode({\n  condition = var.condition\n  \"gcp.account_type\" = var.gcp_account_type\n  \"gcp.credentials.audience\" = var.gcp_credentials_audience\n  \"gcp.credentials.file\" = var.gcp_credentials_file\n  \"gcp.credentials.json\" = var.gcp_credentials_json\n  \"gcp.credentials.service_account_email\" = var.gcp_credentials_service_account_email\n  \"gcp.credentials.type\" = var.gcp_credentials_type\n  \"gcp.organization_id\" = var.gcp_organization_id\n  \"gcp.project_id\" = var.gcp_project_id\n  \"gcp.supports_cloud_connectors\" = var.gcp_supports_cloud_connectors\n  gcp_credentials_cloud_connector_id = var.gcp_credentials_cloud_connector_id\n})}",
      "description": "${var.fleet_package_policy_description}",
      "force": "${var.fleet_package_policy_force}",
      "input_type": "cloudbeat/cis_gcp",
      "input_variables_json": "${jsonencode({\n  cloud_shell_url = var.cloud_shell_url\n  cloud_shell_url_cloud_connectors = var.cloud_shell_url_cloud_connectors\n})}",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "cloud_security_posture",
      "package_policy_name": "cloud_security_posture-findings-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  deployment = var.deployment\n  posture = var.posture\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "cspm",
      "source": "../../fleet_package_policy"
    }
  }
}
