{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "access_key_id": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "api_timeout": {
      "type": "string",
      "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value. NOTE: Supported units for this parameter are h/m/s.",
      "default": "120s"
    },
    "bucket_arn": {
      "type": "string",
      "description": "It is a required parameter for collecting logs via the AWS S3 Bucket.",
      "default": null
    },
    "bucket_list_prefix": {
      "type": "string",
      "description": "Prefix to apply for the list request to the S3 bucket.",
      "default": null
    },
    "collect_s3_logs": {
      "type": "bool",
      "description": "To Collect logs via S3 bucket enable the toggle switch. By default, it will collect logs via SQS Queue.",
      "default": false,
      "nullable": false
    },
    "credential_profile_name": {
      "type": "string",
      "default": null
    },
    "custom_yaml": {
      "type": "string",
      "description": "Additional settings to be added to the configuration. Be careful using this as it might break the input as those settings are not validated and can override the settings specified above. See [`aws-s3` input settings docs](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-aws-s3.html) for details.\n",
      "default": null
    },
    "default_region": {
      "type": "string",
      "description": "Default region to use prior to connecting to region specific services/endpoints if no AWS region is set from environment variable, credentials or instance profile. If none of the above are set and no default region is set as well, `us-east-1` is used. A region, either from environment variable, credentials or instance profile or from this default region setting, needs to be set when using regions in non-regular AWS environments such as AWS China or US Government Isolated.",
      "default": ""
    },
    "endpoint": {
      "type": "string",
      "description": "URL of the entry point for an AWS web service",
      "default": ""
    },
    "file_selectors_yaml": {
      "type": "string",
      "description": "If the SQS queue will have events that correspond to files that this integration shouldn’t process, file_selectors can be used to limit the files that are downloaded. This is a list of selectors which are made up of regex and expand_event_list_from_field options. The regex should match the S3 object key in the SQS message, and the optional expand_event_list_from_field is the same as the global setting. If file_selectors is given, then any global expand_event_list_from_field value is ignored in favor of the ones specified in the file_selectors. Regexes use [RE2 syntax](https://pkg.go.dev/regexp/syntax). Files that don’t match one of the regexes will not be processed.",
      "default": null
    },
    "fips_enabled": {
      "type": "bool",
      "description": "Enabling this option changes the service name from `s3` to `s3-fips` for connecting to the correct service endpoint.",
      "default": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the aws package to use.",
      "default": "2.20.0"
    },
    "interval": {
      "type": "string",
      "description": "Time interval for polling listing of the S3 bucket. NOTE: Supported units for this parameter are h/m/s.",
      "default": "1m"
    },
    "max_number_of_messages": {
      "type": "number",
      "description": "The maximum number of SQS messages that can be inflight at any time.",
      "default": 5
    },
    "number_of_workers": {
      "type": "number",
      "description": "Number of workers that will process the S3 objects listed.",
      "default": 5
    },
    "preserve_duplicate_custom_fields": {
      "type": "bool",
      "description": "Preserve aws.guardduty fields that were copied to Elastic Common Schema (ECS) fields.",
      "default": false,
      "nullable": false
    },
    "preserve_original_event": {
      "type": "bool",
      "description": "Preserves a raw copy of the original event, added to the field `event.original`.",
      "default": false,
      "nullable": false
    },
    "processors_yaml": {
      "type": "string",
      "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.",
      "default": null
    },
    "proxy_url": {
      "type": "string",
      "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
      "default": null
    },
    "queue_url": {
      "type": "string",
      "description": "URL of the AWS SQS queue that messages will be received from. It is a required parameter for collecting logs via the AWS SQS.",
      "default": null
    },
    "region": {
      "type": "string",
      "description": "The name of the AWS region of the end point",
      "default": ""
    },
    "role_arn": {
      "type": "string",
      "default": null
    },
    "secret_access_key": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "session_token": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "shared_credential_file": {
      "type": "string",
      "description": "Directory of the shared credentials file",
      "default": null
    },
    "tags": {
      "type": "list(string)",
      "default": [
        "forwarded",
        "aws-guardduty"
      ],
      "nullable": false
    },
    "visibility_timeout": {
      "type": "string",
      "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request. The maximum is 12 hours. NOTE: Supported units for this parameter are h/m/s.",
      "default": "300s"
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "guardduty"
      ],
      "all_policy_template_inputs": [
        "awshealth-aws/metrics",
        "billing-aws/metrics",
        "cloudtrail-aws-s3",
        "cloudtrail-aws-cloudwatch",
        "cloudtrail-httpjson",
        "cloudwatch-aws-cloudwatch",
        "cloudwatch-aws/metrics",
        "dynamodb-aws/metrics",
        "ebs-aws/metrics",
        "ec2-aws-s3",
        "ec2-aws-cloudwatch",
        "ec2-aws/metrics",
        "ecs-aws/metrics",
        "elb-aws-s3",
        "elb-aws-cloudwatch",
        "elb-aws/metrics",
        "lambda-aws/metrics",
        "natgateway-aws/metrics",
        "firewall-aws-s3",
        "firewall-aws-cloudwatch",
        "firewall-aws/metrics",
        "rds-aws/metrics",
        "s3-aws-s3",
        "s3-aws/metrics",
        "s3_storage_lens-aws/metrics",
        "sns-aws/metrics",
        "sqs-aws/metrics",
        "transitgateway-aws/metrics",
        "usage-aws/metrics",
        "vpcflow-aws-s3",
        "vpcflow-aws-cloudwatch",
        "vpn-aws/metrics",
        "waf-aws-s3",
        "waf-aws-cloudwatch",
        "route53-aws-cloudwatch",
        "route53-aws-s3",
        "cloudfront-aws-s3",
        "redshift-aws/metrics",
        "kinesis-aws/metrics",
        "securityhub-httpjson",
        "inspector-httpjson",
        "guardduty-httpjson",
        "guardduty-aws-s3",
        "apigateway-aws/metrics",
        "apigateway-aws-s3",
        "apigateway-aws-cloudwatch",
        "emr-aws/metrics",
        "emr-aws-s3",
        "emr-aws-cloudwatch",
        "kafka-aws/metrics"
      ],
      "data_stream": "guardduty",
      "data_stream_variables_json": "${jsonencode({\n  api_timeout = var.api_timeout\n  bucket_arn = var.bucket_arn\n  bucket_list_prefix = var.bucket_list_prefix\n  collect_s3_logs = var.collect_s3_logs\n  custom = var.custom_yaml\n  endpoint = var.endpoint\n  file_selectors = var.file_selectors_yaml\n  fips_enabled = var.fips_enabled\n  interval = var.interval\n  max_number_of_messages = var.max_number_of_messages\n  number_of_workers = var.number_of_workers\n  preserve_duplicate_custom_fields = var.preserve_duplicate_custom_fields\n  preserve_original_event = var.preserve_original_event\n  processors = var.processors_yaml\n  queue_url = var.queue_url\n  region = var.region\n  tags = var.tags\n  visibility_timeout = var.visibility_timeout\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "aws-s3",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "aws",
      "package_policy_name": "aws-guardduty-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  access_key_id = var.access_key_id\n  credential_profile_name = var.credential_profile_name\n  default_region = var.default_region\n  proxy_url = var.proxy_url\n  role_arn = var.role_arn\n  secret_access_key = var.secret_access_key\n  session_token = var.session_token\n  shared_credential_file = var.shared_credential_file\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "guardduty",
      "source": "../../fleet_package_policy"
    }
  }
}
