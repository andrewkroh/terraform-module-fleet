{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "access_key_id": {
      "type": "string",
      "default": null
    },
    "aws_account_type": {
      "type": "string",
      "default": null
    },
    "aws_credentials_type": {
      "type": "string",
      "default": null
    },
    "aws_supports_cloud_connectors": {
      "type": "bool",
      "default": null
    },
    "cloud_formation_cloud_connectors_template": {
      "type": "string",
      "description": "Template URL to Cloud Formation Cloud Connectors Stack",
      "default": "https://console.aws.amazon.com/cloudformation/home#/stacks/quickcreate?templateURL=https://elastic-cspm-cft.s3.eu-central-1.amazonaws.com/cloudformation-cloud-connectors-ACCOUNT_TYPE-8.16.0.yml\u0026param_ElasticResourceId=RESOURCE_ID",
      "nullable": false
    },
    "cloud_formation_credentials_template": {
      "type": "string",
      "description": "Template URL to Cloud Formation Cloud Credentials Stack",
      "default": "https://console.aws.amazon.com/cloudformation/home#/stacks/quickcreate?templateURL=https://elastic-cspm-cft.s3.eu-central-1.amazonaws.com/cloudformation-cspm-direct-access-key-ACCOUNT_TYPE-8.16.0.yml",
      "nullable": false
    },
    "cloud_formation_template": {
      "type": "string",
      "description": "Template URL to Cloud Formation Quick Create Stack",
      "default": "https://console.aws.amazon.com/cloudformation/home#/stacks/quickcreate?templateURL=https://elastic-cspm-cft.s3.eu-central-1.amazonaws.com/cloudformation-cspm-ACCOUNT_TYPE-8.16.0.yml\u0026stackName=Elastic-Cloud-Security-Posture-Management\u0026param_EnrollmentToken=FLEET_ENROLLMENT_TOKEN\u0026param_FleetUrl=FLEET_URL\u0026param_ElasticAgentVersion=KIBANA_VERSION\u0026param_ElasticArtifactServer=https://artifacts.elastic.co/downloads/beats/elastic-agent",
      "nullable": false
    },
    "condition": {
      "type": "string",
      "description": "Condition to filter when to collect this input. See [Dynamic Input Configuration](https://www.elastic.co/guide/en/fleet/current/dynamic-input-configuration.html) for details.\n",
      "default": null
    },
    "credential_profile_name": {
      "type": "string",
      "default": null
    },
    "deployment": {
      "type": "string",
      "description": "Chosen deployment type (aws/gcp/azure/eks/k8s)",
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the cloud_security_posture package to use.",
      "default": "1.12.0-preview02"
    },
    "posture": {
      "type": "string",
      "description": "Chosen posture type (cspm/kspm)",
      "nullable": false
    },
    "role_arn": {
      "type": "string",
      "default": null
    },
    "secret_access_key": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "session_token": {
      "type": "string",
      "default": null,
      "sensitive": true
    },
    "shared_credential_file": {
      "type": "string",
      "description": "Directory of the shared credentials file",
      "default": null
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "findings"
      ],
      "all_policy_template_inputs": [
        "kspm-cloudbeat/cis_k8s",
        "kspm-cloudbeat/cis_eks",
        "cspm-cloudbeat/cis_aws",
        "cspm-cloudbeat/cis_gcp",
        "cspm-cloudbeat/cis_azure",
        "vuln_mgmt-cloudbeat/vuln_mgmt_aws"
      ],
      "data_stream": "findings",
      "data_stream_variables_json": "${jsonencode({\n  access_key_id = var.access_key_id\n  \"aws.account_type\" = var.aws_account_type\n  \"aws.credentials.type\" = var.aws_credentials_type\n  \"aws.supports_cloud_connectors\" = var.aws_supports_cloud_connectors\n  condition = var.condition\n  credential_profile_name = var.credential_profile_name\n  role_arn = var.role_arn\n  secret_access_key = var.secret_access_key\n  session_token = var.session_token\n  shared_credential_file = var.shared_credential_file\n})}",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "cloudbeat/cis_aws",
      "input_variables_json": "${jsonencode({\n  cloud_formation_cloud_connectors_template = var.cloud_formation_cloud_connectors_template\n  cloud_formation_credentials_template = var.cloud_formation_credentials_template\n  cloud_formation_template = var.cloud_formation_template\n})}",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "cloud_security_posture",
      "package_policy_name": "cloud_security_posture-findings-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  deployment = var.deployment\n  posture = var.posture\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "cspm",
      "source": "../../fleet_package_policy"
    }
  }
}
