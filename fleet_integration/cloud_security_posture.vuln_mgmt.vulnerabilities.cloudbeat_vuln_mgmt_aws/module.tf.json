{
  "//": "Generated by fleet-terraform-generator - DO NOT EDIT",
  "variable": {
    "cloud_formation_template": {
      "type": "string",
      "description": "Template URL to Cloud Formation Quick Create Stack",
      "default": "https://console.aws.amazon.com/cloudformation/home#/stacks/quickcreate?templateURL=https://elastic-cspm-cft.s3.eu-central-1.amazonaws.com/cloudformation-cnvm-8.14.0.yml\u0026stackName=Elastic-Vulnerability-Management\u0026param_EnrollmentToken=FLEET_ENROLLMENT_TOKEN\u0026param_FleetUrl=FLEET_URL\u0026param_ElasticAgentVersion=KIBANA_VERSION\u0026param_ElasticArtifactServer=https://artifacts.elastic.co/downloads/beats/elastic-agent",
      "nullable": false
    },
    "deployment": {
      "type": "string",
      "description": "Chosen deployment type (aws/gcp/azure/eks/k8s)",
      "nullable": false
    },
    "fleet_agent_policy_id": {
      "type": "string",
      "description": "Agent policy ID to add the package policy to."
    },
    "fleet_data_stream_namespace": {
      "type": "string",
      "description": "Namespace to use for the data stream.",
      "default": "default"
    },
    "fleet_package_policy_description": {
      "type": "string",
      "description": "Description to use for the package policy.",
      "default": ""
    },
    "fleet_package_policy_name_suffix": {
      "type": "string",
      "description": "Suffix to append to the end of the package policy name.",
      "default": ""
    },
    "fleet_package_version": {
      "type": "string",
      "description": "Version of the cloud_security_posture package to use.",
      "default": "1.9.0-preview05"
    },
    "posture": {
      "type": "string",
      "description": "Chosen posture type (cspm/kspm)",
      "nullable": false
    }
  },
  "output": {
    "id": {
      "description": "Package policy ID",
      "value": "${module.fleet_package_policy.id}"
    }
  },
  "module": {
    "fleet_package_policy": {
      "agent_policy_id": "${var.fleet_agent_policy_id}",
      "all_data_streams": [
        "vulnerabilities"
      ],
      "all_policy_template_inputs": [
        "kspm-cloudbeat/cis_k8s",
        "kspm-cloudbeat/cis_eks",
        "cspm-cloudbeat/cis_aws",
        "cspm-cloudbeat/cis_gcp",
        "cspm-cloudbeat/cis_azure",
        "vuln_mgmt-cloudbeat/vuln_mgmt_aws"
      ],
      "data_stream": "vulnerabilities",
      "description": "${var.fleet_package_policy_description}",
      "input_type": "cloudbeat/vuln_mgmt_aws",
      "input_variables_json": "${jsonencode({\n  cloud_formation_template = var.cloud_formation_template\n})}",
      "namespace": "${var.fleet_data_stream_namespace}",
      "package_name": "cloud_security_posture",
      "package_policy_name": "cloud_security_posture-vulnerabilities-${var.fleet_data_stream_namespace}${var.fleet_package_policy_name_suffix}",
      "package_variables_json": "${jsonencode({\n  deployment = var.deployment\n  posture = var.posture\n})}",
      "package_version": "${var.fleet_package_version}",
      "policy_template": "vuln_mgmt",
      "source": "../../fleet_package_policy"
    }
  }
}
